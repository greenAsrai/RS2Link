% !TEX root = ./main_RS2L_LNCS.tex


%\section{Background on Core Network Algebra (CNA)}
%We briefly report the basic concepts of the \CNA~calculus.
%
%\paragraph{Links and link chains}
%A link is a pair $\link{\alpha}{\beta}$
%that records the source and the target sites 
%of a communication,  meaning that the input available 
%at the source site $\alpha$ can be forwarded to the target one $\beta$.  
%Links are suitably combined in link chains to describe 
%how information can be routed across processes before 
%arriving at their destination.
%
%More formally, let $\mathcal{C}$ be the set of channels, ranged over by $a,b,c,...$, and 
%let $\mathcal{A} = \mathcal{C} \cup \setof{\silent} \cup \setof{{\noacts}}$ be the set of actions, ranged over by $\alpha,\beta,\gamma,...$,
%where the symbol $\silent$ denotes a \emph{silent} action, while the symbol $\noact$ denotes a \emph{virtual} (non-specified) action.
%A \emph{link} is a pair $\ell=\link{\alpha}{\beta}$;
% it can be read as forwarding the input available on $\alpha$ to $\beta$, and we call $\alpha$ the \emph{source site} of $\ell$ and $\beta$ the \emph{target site} of $\ell$.
%%
%A link $\link{\alpha}{\beta}$ is \emph{solid} if $\alpha,\beta \neq \ \noacts$; 
%the link $\link{\noact}{\noact}$ is called \emph{virtual}.
%A link is \emph{valid} if it is solid or virtual.
%We let $\mathcal{L}$ be the set of valid links.
%% ranged over by $p,q,r,...$.
%
%All the  processes that want to participate to a single interaction, must offer
% a link chain composed the same number of links: each link chain must
% be formed by only one solid link and all the other ones must be virtual.
% The positions of the solid links in each chain must be different and 
% sibling links must be such that the 
%right hand channel of the previous link must match with the left hand channel of the
%next link.  Please note that virtual links match with any channel name.
%
%More formally, a \emph{link chain} is a 
%finite sequence $s = \ell_{1}...\ell_{n}$ of (valid) links  $\ell_{i} = \link{\alpha_{i}}{\beta_{i}}$ such that:
%\begin{enumerate}
%
%\item for any $i\in [1,n-1]$, 
%$\left\{\begin{array}{ll}
%\beta_{i},\alpha_{i+1}\in \mathcal{C} & \mbox{ implies } \beta_{i} = \alpha_{i+1}\\
%\beta_{i}=\silent & \mbox{ iff } \alpha_{i+1}=\silent
%\end{array}\right.
%$
%\item  $\exists i \in [1,n]. \ \ell_i \neq \link{\noact}{\noact}$.
%\end{enumerate}
%
%
%\paragraph{Syntax and semantics}
%
%The syntax of \CNA is as follow:
%
%
%\begin{definition}
%The \CNA\ processes are generated by the following grammar:
%\[
%\begin{array}{rcl}
%P,Q & ::= &
%\nil \prodsep
%%X \prodsep
%\ell. P  \prodsep
%P+Q \prodsep
%P|Q \prodsep
%\restrict{a} P \prodsep
%P[\phi] \prodsep
%A
%\end{array}
%\]
%\noindent
%where $\ell$ is a solid link ( i.e.\  $\ell = \link{\alpha}{\beta}$ with $\alpha,\beta\neq \ \noacts$) and $A$ is a process identifier for which we assume a definition $A \defeq P$ is available in a given set $\Delta$ of (possibly recursive) process definitions.
%\end{definition}
%
%The operational semantics is defined in terms of a Labelled Transition System, in which states are \CNA\ processes, labels are link chains, and transitions are generated by the SOS rules in Figure~\ref{fig:cnasos}.  The semantics makes use of the an equivalence relation that allow rule  $(Act)$ 
%of the semantics to decide the dimention (i.e. the maximum number of the participants) of the
%interaction a process want to take part in.
%
%\begin{definition}[Equivalence $\blackstretcheq$]\label{def:black}
%We let $\blackstretcheq$ be the least equivalence relation 
%%(i.e.~closed under reflexivity, symmetry and transitivity) 
%over link chains closed under the axioms (whenever both sides are well defined link chains):
%\[
%\begin{array}{rclcrcl}
%s\link{\noact}{\noact} & \blackstretcheq &  s & \qquad &
%s_1 \startchain{\noact}\chainedlink{\noact}{\noact}\chainend{\noact}s_2 & \blackstretcheq & s_1 \link{\noact}{\noact} s_2\\
%\link{\noact}{\noact}s & \blackstretcheq & s & &
%s_1 \startchain{\alpha}\chainedlink{a}{a}\chainend{\beta} s_2
%& \blackstretcheq & 
%s_1 \startchain{\alpha}\chainedlink{a}{\noact}\chainedlink{\noact}{a}\chainend{\beta}s_2 
%\end{array}
%\]
%\end{definition}
%
%
%
%\begin{figure}[t]
%\begin{center} 
%\begin{prooftree} 
%\AxiomC{$s \blackstretcheq \ell $} %\mbox{($\ell$ {\em only} solid link in $s$)}
%\RightLabel{\scriptsize(\textit{Act})}
%\UnaryInfC{$\ell.P \xrightarrow{s} P$} 
%\DisplayProof
%\
%\AxiomC{$P \xrightarrow{s} P'$} 
%\RightLabel{\scriptsize(\textit{Lsum})}
%\UnaryInfC{$P+Q \xrightarrow{s} P'$} 
%\DisplayProof
%\
%\AxiomC{$P \xrightarrow{s} P'$} 
%\RightLabel{\scriptsize(\textit{Res})}
%\UnaryInfC{$\restrict{a}P \xrightarrow{\restrict{a}s} \restrict{a}P'$} 
%%\DisplayProof
%%\,
%%\AxiomC{$Q \xrightarrow{s} Q'$} 
%%\RightLabel{\scriptsize(Rsum)}
%%\UnaryInfC{$P+Q \xrightarrow{s} Q'$} 
%\end{prooftree} 
%\end{center}
%
%\begin{center} 
%\begin{prooftree} 
%\AxiomC{$P \xrightarrow{s} P'$} 
%\RightLabel{\scriptsize(\textit{Rel})}
%\UnaryInfC{$P[\phi] \xrightarrow{s[\phi]} P'[\phi]$} 
%\DisplayProof
%\
%\AxiomC{$P \xrightarrow{s} P'$} 
%\RightLabel{\scriptsize(\textit{Lpar})}
%\UnaryInfC{$P|Q \xrightarrow{s} P'|Q$} 
%\DisplayProof
%\ 
%%\AxiomC{$Q \xrightarrow{s} Q'$} 
%%\RightLabel{\scriptsize(Rpar)}
%%\UnaryInfC{$P|Q \xrightarrow{s} P|Q'$} 
%%\end{prooftree} 
%%\end{center}
%%\begin{center} 
%%\begin{prooftree} 
%\AxiomC{$P \xrightarrow{s} P'$} 
%\AxiomC{$Q \xrightarrow{s'} Q'$} 
%\RightLabel{\scriptsize(\textit{Com})}
%\BinaryInfC{$P|Q \xrightarrow{\merges{s}{s'}} P'|Q'$} 
%\DisplayProof
%\end{center}
%\begin{center}
%%\AxiomC{$P[\subst{\recproc{X}{P}}{X}] \xrightarrow{s} P'$} 
%%\RightLabel{\scriptsize(Rec)}
%%\UnaryInfC{$\recproc{X}{P} \xrightarrow{s} P'$} 
%\AxiomC{$P \xrightarrow{s} P'$}
% \AxiomC{$(A \defeq P)\in\Delta$}
%\RightLabel{\scriptsize(\textit{Ide})}
%\BinaryInfC{$A \xrightarrow{s} P'$} 
%\end{prooftree} 
%\end{center}
%\caption{SOS semantics of the \CNA\  (rules (\textit{Rsum}) and (\textit{Rpar}) are omitted).}
%\label{fig:cnasos}
%\end{figure}
%






\newpage

\section{Omitted Proofs}
In this section we report the proofs for the results in Section~\ref{sec:trans}.
%\noindent
%We recall Lemma~\ref{lem:struct} (the original appears on p.\,\pageref{lem:struct}).

\lemmastruct*
\begin{proof}
  We prove the two items separately:
  \begin{enumerate}
\item by Definition~\ref{def:trans}, all the names $r_j,p_j$; all the names $s_i,s_o$, in all their annotated versions, and all the names $cxt_h$, are restricted. 
Moreover, the only prefixes that start with $\silent$ are those associated to reaction $a_1$ (as $r_1=\silent$) and the only prefixes that end with $\silent$ are those associated to reaction $a_u$ (as $p_{u+1} = \silent$, where $u$ is the number of reactions).
Thus all the prefixes associated with reactions and contexts must be concatenated (remember that $r_{u+1} = cxt_1$ and $cxt_{w+1}=p_1$, where $w$ is the number of entities), forming the backbone of the label.
Since all context processes are involved, then all entities processes are also involved.
Then, all the processes $P_a$, $P_s$ (or $\overline{P_s}$), and $Cxt_h$  must participate to each transition.
 \item for each reaction $aj \in A$, the c\CNA \ code of  $P_{aj}$ leaves one virtual link between two solid links of the types $\link{r_j}{\dots} \chainedlink{s_{i}}{\noact}\chainedlink{\noact}{s_{o}}\link{}{\dots}\link{}{r_{j+1}} ^{\dots}\link{p_j}{\dots}\link{}{p_{j+1}}$. Then, it derives that the process $P_{s}$, encoding the behaviour of entity $s$, can participate by filling the virtual link in the above transition by only offering one solid link of the type $\link{s_{i}}{s_{o}}$. In fact, there is no other way to generate a solid chain from $s_{i}$ to $s_{o}$.
 The same reasoning holds for the processes $Cxt_h$ and for all the annotated versions of $s_i,s_o$.
% $P_{s_1}$ can not participate with a link chain, as by juxtaposing  $\link{s_{1i}}{s_{1o}}$, not valid
 %link chains would be generated.
   \end{enumerate}
  \end{proof}
  
  
%\noindent
%We recall Proposition~\ref{prop:corr1}
%(the original appears on p.\,\pageref{prop:corr1}).
\propcorruno*
 
 %\begin{proposition}(correctness 1)\\
 %\label{lem:struct}
%  Let ${\cal A} = (S, A)$ be a rs, and let  $\pi=(\gamma,\delta)$ be a $n$-step interactive process in $A$, with
% $\gamma = C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$.
%% We define $\pi' = (\gamma',\delta')$ with $\gamma' = C_0',\dots,C_{n-1}'$ and $\delta' = D_0',\dots,D_{n-1}'$ as $C_0' = C_1 \cup D_1$,  and
%% $C_i' = C_{i+1}$, $D_{i}' = D_{i+1}$ with $ 1 \leq i < n$.
%  Let   $P=[|{\cal A},\gamma|]$ be  its c\CNA~translation, and let $P'$ be such that $P \xrightarrow{\link{\silent}{\silent}}P'$.% then $P' = [|{\cal A},\gamma' |]$. 
%Then it holds that\\
% $P= \restrict{reacts,ctxs,ents} (\Pi_{a \in A}P_a| \Pi_{s \in S}CXT_s | \Pi_{s \in C_0}P_s| \Pi_{s \notin C_0}\overline{P}_s)$\\
% $P'= \restrict{reacts,ctxs,ents} (\Pi_{a \in A}P_a| \Pi_{s \in S}CXT_s | \Pi_{s \in C_1 \cup D_1}P_s| \Pi_{s \notin C_1 \cup D_1}\overline{P}_s)$
 %\end{proposition}
 \begin{proof}
 First, we note that all the channels in the system are restricted, see Def.~\ref{def:trans}, then
 it holds that the transition labels are of the form  $v=\link{\silent}{\silent}\dots\link{\silent}{\silent}$.\\
 Now,
by Definition~\ref{def:trans} and by Lemma~\ref{lem:struct}.1, all the  channels $r_j,p_j$, with
 $j \in [1,\dots,u]$, and $cxt_h$, with $h \in [1, \dots, w]$, and all the annotated versions of 
 $s_i$, $s_o$ are restricted. Also, processes $Cxt_s$ always requires the 
 interaction with $P_s$ on either on channels $\hat{s}_i$, $\hat{s}_o$ or on channels 
 $\underline{s}_i$, $\underline{s}_o$.
 It derives that all the processes: $P_a$  (coding the behaviour of reaction $a \in A$), $P_s$ (coding the behaviour of entity $s \in S$), and $Cxt_s$ (coding the behaviour of the context regarding the entity $s$) have been involved in the transition. 
We have the following cases:
\begin{description}
\item[(a)] processes $P_a$ encoding a reaction $a$,  with serial  number $j$, producing the entity $s$ provide a code of this type:
%By Lemma~\ref{lem:compl1}, all the processes $A_j$, and $Cxt_h$ participated in the tr
%The code executed by any process encoding rule $R_i$ producing $e$ is 
$P_a\defeq \link{r_j}{\dots}\chainedlink{r_{j+1}}{\noact}\chainedlink{\noact}{p_j}\link{}{\dots}\chainedlink{\tilde{s}_i}{\noact}\chainedlink{\noact}{\dots}\link{\tilde{s}_o}{\dots} \chainend{p_{j+1}}.P_a $;
\item[(b)] processes $P_a$ encoding a reaction $a$, with serial number $j$, consuming the entity $s$
% without producing it, 
provide a code of this type: 
$P_a\defeq \link{r_j}{\dots}\chainedlink{s_i}{\noact}\chainedlink{\noact}{}\link{s_o}{\dots} \chainedlink{r_{j+1}}{\noact}\chainedlink{\noact}{p_j}\link{}{\dots}\link{}{p_{j+1}}.P_a $;
\item[(c)]  processes $P_a$ encoding a reaction $a$, with serial number $j$, requiring the absence of the entity $s$ provide a code of this type: \\
$P_a\defeq \link{r_j}{\dots}\chainedlink{\overline{s}_i}{\noact}\chainedlink{\noact}{}\link{\overline{s}_o}{\dots} \chainedlink{r_{j+1}}{\noact}\chainedlink{\noact}{p_j}\link{}{\dots}\link{}{p_{j+1}}.P_a $;
\item[(d)] processes $P_a$ encoding a reaction $a$ (that cannot be applied), with serial number $j$, 
execute a code  capturing either the absence of one of its reactants (case 1), or the presence  of one of its inhibitors (case 2):
\begin{enumerate}
\item $P_a\defeq \link{r_j}{\dots}\chainedlink{\overline{s}_i}{\noact}\chainedlink{\noact}{}\link{\overline{s}_o}{\dots} \chainedlink{r_{j+1}}{\noact}\chainedlink{\noact}{p_j}\link{}{\dots}\link{}{p_{j+1}}.P_a $.
\item $P_a\defeq \link{r_j}{\dots}\chainedlink{s_i}{\noact}\chainedlink{\noact}{}\link{s_o}{\dots} \chainedlink{r_{j+1}}{\noact}\chainedlink{\noact}{p_j}\link{}{\dots}\link{}{p_{j+1}} .P_a $.
\end{enumerate}
\end{description}
%It is worth nothing that there could be other processes $P_a$ encoding  a reaction $a \in A$ that do not
%involve the entity $s$.\\
Now, we consider the structure of the process $Cxt_s = Cxt^0_s$. By Definition~\ref{def:trans}, $Cxt^0_s$ is the unique process encoding the behaviour of the context regulating the supply of $s$. 
The code of the process $Cxt^t_s$, with $t \geq 0$, has the following structure: 
\begin{description}
\item[(e)] $Cxt^i_s \defeq  \startchain{cxt_h}\chainedlink{\hat{s}_i}{\noact}\chainedlink{\noact}{\hat{s}_o}\chainend{cxt_{h+1}}. Cxt^{i+1}_{s}$, if $s \in C_{i+1}$;
\item[(f)] $Cxt^i_s \defeq  \startchain{cxt_h}\chainedlink{\underline{s}_i}{\noact}\chainedlink{\noact}{\underline{s}_o}\chainend{cxt_{h+1}}. Cxt^{i+1}_{s}$, if $s \notin C_{i+1}$;
%\item[(e)] $Cxt_{s}^1 \defeq \startchain{cxt_h}\chainedlink{\hat{s}_i}{\noact}\chainedlink{\noact}{\hat{s}_o}\chainend{cxt_{h+1}}. Cxt_{s}^{2}$, if  $s \in C_1$ (and hence $s \in C_0')$;
%\item[(f)] $Cxt_{s}^1 \defeq \startchain{cxt_h}\chainedlink{\underline{s}_i}{\noact}\chainedlink{\noact}{\underline{s}_o}\chainend{cxt_{h+1}}. Cxt_{s}^{2}$, if  $s \notin C_1$.
\end{description}


%$R_j \defeq \startchain{rule_j}\chainedlink{e_i}{\noact}\chainedlink{\noact}{e_o}\chainedlink{\overline{e'}_i}{\noact} \chainedlink{\noact}{\overline{e'}_o}\chainedlink{\tilde{e''}_i}{\noact}\chainedlink{\noact}{\tilde{e''}_o} \chainend{rule_{j+1}}.R_j + \dots$, with $e',e''\neq e $.\\
%The code executed by any rule $j$ not requiring $e$ is $R_j \defeq \startchain{rule_j}\chainedlink{e_i}{\noact}\chainedlink{\noact}{e_o} \chainend{rule_{j+1}}.R_j + \dots$.\\
\noindent
The code executed by  $P_s$ has the following structure:
\begin{description}
\item[(g)] $P_s \defeq  \sum_{h,k\geq0}(\startchain{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}) ^h\, \startchain{\hat{s}_i}\chainedlink{\hat{s}_o}{\noact}\chainend{\noact}
 (\startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact})^k\,.P_s $, if $s \in C_{i+1}$;
% \underbrace{ \startchain{s_i}\chainedlink{s_o}{\noact}\chainedlink{\noact}{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}...}_{v\ times}\underbrace{ \startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainedlink{\noact}{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact}...}_{z\ times}\link{\hat{s}_i}{\hat{s}_o}.P_s $, if $s \in C_{i+1}$;
%\item[()] $P_s \defeq  \underbrace{ \startchain{s_i}\chainedlink{s_o}{\noact}\chainedlink{\noact}{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}...}_{v\ times}\link{\hat{s}_i}{\hat{s}_o}.P_s $, if $s \in C_1$ %(and hence $s \in C_0'$)
\item[(h)] $P_s \defeq \sum_{h \geq 0,k\geq 1}(\startchain{s_i}\chainedlink{s_o}{\noact}\chainend{\noact})^h\ \startchain{\underline{s}_i}\chainedlink{\underline{s}_o}{\noact}\chainend{\noact} (\startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact})^k
.P_s$, if $s \not\in C_{i+1}$
% \underbrace{ \startchain{s_i}\chainedlink{s_o}{\noact}\chainedlink{\noact}{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}...}_{v\ times}\underbrace{ \startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainedlink{\noact}{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact}...}_{z >0 \ times}\link{\underline{s}_i}{\underline{s}_o}.P_s$, if $s \in C_{i+1}$
\item[(i)] $P_s \defeq  \sum_{h\geq0} (\startchain{s_i}\chainedlink{s_o}{\noact}\chainend{\noact})^h
%{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}...}_{v\ times}
\link{\underline{s}_i}{\underline{s}_o}.\overline{P}_s$, if $s \notin C_{i+1}$
\end{description}
where, by Lemma~\ref{lem:struct}.2, $h$ is the number of reactions requiring the presence of $s$ plus possibly some reactions not requiring $s$; and $k$ is the number of reactions producing $s$.
The code executed by  $\overline{P}_s$ has the following structure:
\begin{description}
\item[(g')] $\overline{P}_s \defeq  \sum_{h,k\geq 0}(\startchain{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainend{\noact})^h  \, \startchain{\hat{s}_i}\chainedlink{\hat{s}_o}{\noact}\chainend{\noact}
 (\startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact})^k\,.P_s $, if $s \in C_{i+1}$;
% \underbrace{ \startchain{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainedlink{\noact}{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainend{\noact}...}_{v\ times}\underbrace{ \startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainedlink{\noact}{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact}...}_{z\ times}\link{\hat{s}_i}{\hat{s}_o}.P_s $, if $s \in C_{i+1}$;
%\item[()] $P_s \defeq  \underbrace{ \startchain{s_i}\chainedlink{s_o}{\noact}\chainedlink{\noact}{s_i}\chainedlink{s_o}{\noact}\chainend{\noact}...}_{v\ times}\link{\hat{s}_i}{\hat{s}_o}.P_s $, if $s \in C_1$ %(and hence $s \in C_0'$)
\item[(h')] $\overline{P}_s \defeq  \sum_{h \geq 0,k\geq 1} (\startchain{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainend{\noact})^h\ \startchain{\underline{s}_i}\chainedlink{\underline{s}_o}{\noact}\chainend{\noact} (\startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact})^k.P_s$, if $s \notin C_{i+1}$

% \underbrace{ \startchain{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainedlink{\noact}{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainend{\noact}...}_{v\ times}\underbrace{ \startchain{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainedlink{\noact}{\tilde{s}_i}\chainedlink{\tilde{s}_o}{\noact}\chainend{\noact}...}_{z >0 \ times}\link{\underline{s}_i}{\underline{s}_o}.P_s$, if $s \in C_{i+1}$
\item[(i')] $\overline{P}_s \defeq  \sum_{h \geq 0}(\startchain{\overline{s}_i}\chainedlink{\overline{s}_o}{\noact}\chainend{\noact})^h\,\link{\underline{s}_i}{\underline{s}_o}.\overline{P}_s$, if $s \notin C_{i+1}$
\end{description}
 \noindent
where, by Lemma~\ref{lem:struct}.2, $h$ is the number of reactions requiring the absence of $s$ plus possibly some reactions  requiring $s$; and $k$ is the number of reactions producing $s$.\\
 
\noindent 
It is worth nothing that, depending on the presence ($P_s$) or the absence ($\overline{P}_s$) of each entity $s$, for each process $P_a$ (encoding a reaction $a$) the choice between the execution of the reaction code (points {\bf (a)}, {\bf (b)}, {\bf (c)}) or  the code expressing that reaction $a$ is not applicable (point {\bf (d)}) is deterministic.
Also, the building of the code of processes $Cxt_s$ (points {\bf (e)}, {\bf (f)}), follows the evolution of $\gamma$.
It derives that the trend followed by the processes $P_s$ (or $\overline{P}_s$) is also deterministic (points {\bf (g)}, {\bf (h)}, {\bf (i)} or {\bf (g')}, {\bf (h')}, {\bf (i')}), leading to $P' = \llbracket {\cal A},\gamma^1\rrbracket$.
 \end{proof}
 
%  \begin{corollary}[correctness 1]
% \label{cor:complet1}
% Let ${\cal A} = (S, A)$ be a rs, and let  $\pi=(\gamma,\delta)$ be a $n$-step interactive process in $A$, with
% $\gamma = C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$. Let   $P=[|{\cal A},\gamma|]$ be  its c\CNA~translation. We define $\pi' = (\gamma',\delta')$ with $\gamma' = C_0',\dots,C_{n-1}'$ and $\delta' = D_0',\dots,D_{n-1}'$ as $C_0' = C_1 \cup D_1$,  and
% $C_i' = C_{i+1}$, $D_{i}' = D_{i+1}$ with $ 1 \leq i < n$. Then,
% if $\exists$ $P'$, $P''$ such that $P \xrightarrow{\link{\silent}{\silent}} P'$ and $P \xrightarrow{\link{\silent}{\silent}} P''$, then $P' = P''$.
%\end{corollary}
% \begin{proof}
% %\noindent
%%{\bf Point 2.}\\
%By Definition~\ref{def:trans} if follows that:
%\begin{enumerate}
%\item for the processes $P_a$, the choice  between applying the behaviour
%corresponding of applying reaction $a$ or one of its negations is deterministic, as it depends on the presence of the required reactants ($P_s$) and the absence of its inhibitors ($\overline{P}_s$);
%\item the behaviour of processes $Cxt_s$ are deterministic, as their  behaviour is driven by the component 
%$\gamma$ of the corresponding reactive system.
%\end{enumerate}
%It derives that for each process $P_s$, its continuation ($P_s$ or $\overline{P}_s$) is deterministic.
%And we are done.
%
% \end{proof}
 
 
% \begin{proposition}[correctness2]
% \label{prop:correctness1}
% Let $P$ be a c\CNA \ process such that $\exists$ a $rs$ ${\cal A}$ and a $n$-step interactive process $\pi=(\gamma,\delta)$ with $\gamma =C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$ such that $P= [|{\cal A},\gamma|]$. 
% %We set $\pi'=(\gamma',\delta')$ with $\gamma'=C_0',\dots,C_{n-1}'$,  $\delta'=D_0',\dots,D_{n-1}$,  where $C_0'= C_1 \cup D_1$, $C_i'= C_{i+1}$, $D_i=D_{i+1}'$,  and $1 \leq i < n$.
%Then,   $\exists$ $P'$ and $\pi'=(\gamma',\delta')$ such that $P \xrightarrow{\link{\silent}{\silent}}P'$, $P' =[|{\cal A},\gamma'|]$.
% \end{proposition} 
% \begin{proof}
% By Lemma~\ref{lem:compl2},  $\exists !$ $P'$ such that $P \xrightarrow{\link{\silent}{\silent}}P'$.\\
% By Definition~\ref{def:trans}, $P= \restrict{reacts,ctxs,ents}(\Pi_{a \in A}P_a | \Pi_{s \in S}CXT_s|\Pi_{s\in C_0} P_s | \Pi_{s \notin C_0}\overline{P}_s)$.\\
% By Lemma~\ref{lem:struct}, \\$P' =  \restrict{reacts,ctxs,ents}(\Pi_{a \in A}P_a | \Pi_{s \in S}CXT_s|\Pi_{s\in C_1 \cup D_1} P_s | \Pi_{s \notin C_1 \cup D_1}\overline{P}_s)$ 
%  Then, we set $\gamma' = C_0',\dots,C_{n-1}'$ and $\delta'=D_0',\dots,D_n'$ as
%  We set $C_0'=C_1 \cup D_1$, $C_i' = C_{i+1}$, and $D_i' = D_{i+1}$, with $1 \leq  i < n-1$.
%  And we are done.
% \end{proof}
%
% 
% 

%\noindent
% We recall Corollary~\ref{corr:corr2}
%(the original appears on p.\,\pageref{corr:corr2}).
\corrcorrdue*

% \begin{corollary}[correcteness2]
% %\label{prop:correctness2}
%  Let $P$ a  c\CNA process such that exists a rs ${\cal A}$ and a $n$-step  interactive process $\pi=(\gamma,\delta)$ with $\gamma =C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$ such that $P= [|{\cal A},\gamma|]$. 
% %We set $\pi'=(\gamma',\delta')$ with $\gamma'=C_0',\dots,C_{n-1}'$,  $\delta'=D_0',\dots,D_{n-1}$,  where $C_0'= C_1 \cup D_1$, $C_i'= C_{i+1}$, $D_i=D_{i+1}'$,  and $1 \leq i < n$.
%Then,   $\exists$ $P''$ and $\pi''=(\gamma'',\delta'')$ such that $P \xrightarrow{\link{\silent}{\silent}}^{w-1}P''$, $P'' =[|{\cal A},\gamma''|]$.
%%such that $P=[|{\cal A}|]$, then if $P \rightarrow^* P'$, then $\exists$ ${\cal A'}$ such that ${\cal A}$  evolves in ${\cal A'}$ and $P'=[|{\cal A'}|]$.
% \end{corollary}
\begin{proof}
We proceed by induction on the transition number $j \geq 0$.\\
% case $j=0$\\
% It is enough to set $C_0' = C_0 \cup D_0$ and $P' =P$.\\
 case $j=1$\\
 This case falls into the case of Proposition~\ref{prop:corr1}.\\
 case $j>1$\\
By inductive hypothesis, it holds that $\exists$ $P'$ such that $P \xrightarrow{\link{\silent}{\silent}\dots \link{\silent}{\silent}}^{j-1} P'$ and $P' = \llbracket{\cal A},\gamma^{j-1}\rrbracket$.\\
%, with $1 \leq  i < t-1$.\\
As $P'$ is the encoding of an extended interactive process, by Proposition~\ref{prop:corr1}, it exists $P''$  such that $P' \xrightarrow{\link{\silent}{\silent}\dots\link{\silent}{\silent}} P''$,
 and $P'' = \llbracket{\cal A},\gamma^j\rrbracket$. 
% By Lemma~\ref{lem:compl2}.2, if $\exists$ $P'$ such that $P'' \xrightarrow{\link{\silent}{\silent}} P'$, then $P'$ is 
 %unique, and by Lemma~\ref{lem:compl2}.1 $P' = [|{\cal A},\gamma'|]$. 
%By Proposition~\ref{prop:corr1}, we know that  $C_0''=C_1' \cup D_1'$, $C_i''= C_{i+1}'$,
% and $D_i'' = D_{i+1}'$.  And we are done, as $C_0''=C_1' \cup D_1' = C_j \cup D_j$, $C_i''= C_{i+1}' = C_{i+j}$,  and $D_i'' = D_{i+1}'= D_{i+j}$.
\end{proof}

%\noindent
%We recall Proposition~\ref{prop:compl1}
%(the original appears on p.\,\pageref{prop:compl1}).
\propcompluno*

% \begin{proposition}[completeness1]
% \label{lem:compl2}
% Let ${\cal A} = (S, A)$ be a rs, and let  $\pi=(\gamma,\delta)$ be a $n$-step interactive process in $A$, with
% $\gamma = C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$. Let   $P=[|{\cal A},\gamma|]$ be  its c\CNA~translation. We define $\pi' = (\gamma',\delta')$ with $\gamma' = C_0',\dots,C_{n-1}'$ and $\delta' = D_0',\dots,D_{n-1}'$ as $C_0' = C_1 \cup D_1$,  and
% $C_i' = C_{i+1}$, $D_{i}' = D_{i+1}$ with $ 1 \leq i < n$. Then
% % following holds:
% %\begin{enumerate} 
% %\item  
% $\exists$ $P'$ such that $P \xrightarrow{\link{\silent}{\silent}} P'$ and  $P'=[|{\cal A},\gamma'|]$;
% %\item if $\exists$ $P'$, $P''$ such that $P \xrightarrow{\link{\silent}{\silent}} P'$ and $P \xrightarrow{\link{\silent}{\silent}} P''$, then $P' = P''$.
% %\end{enumerate}
% \end{proposition} 
 \begin{proof}
% {\bf Point 1.}\\
By Proposition~\ref{prop:corr1}, if there exists $P'$ such that $P\xrightarrow{\link{\silent}{\silent}\dots \link{\silent}{\silent} }P'$, then the structure of  $P'$ is deterministically computed.\\
Now, to prove that always exists $P'$, we observe that even in the case no reaction $a$ is applicable in  the interactive process $\pi$ in $A$, then process $P$ can always execute a step transition, as its subprocesses $P_a$ can always execute one of the {\em alternative code
for when reaction $a$ is not applicable} (see Definition~\ref{def:trans}, code for $P_a$ processes).

 
%The proof proceeds by cases on the possible evolution of each element  $s \in S$, 
%following the evolution from $C_0$ to $C_0'$.\\
%
% %Let  ${\cal A} = (S, A)$ be a reaction system and let $e$ be an element in the system.
% % Then 
%Let $\pi' = (\gamma', \delta')$ be the evolution of  $\pi$ after one step. There are four cases to be considered: \ 
% 1) \ $s \in C_0$, $s \in C_0'$; \ 2)\  $C_0 \in S$, $s \notin C_0'$; \ 3)\  $s \notin C_0$, $s \notin C_0'$; \ 4)\  $s \notin C_0$, $s \in C_0'$.\\
%
%
%Before considering each one of the four previous cases, we analyse the code structure of the processes
%involved in the c\CNA \ transition  mimicking the one step evolution from $C_0$ to $C_0'$.
%
%
%\noindent
%\underline{case  $s \in C_0$ and $s \in C_0'$}\\
%We have to prove that the process $P_s$ is a subprocess of $P'$.\\
%By hypothesis, one of the three following situations must have been took place:
%\begin{enumerate}
%\item at least one rule in $A$ producing the element $s$  has been applied, i.e. $s \in D_1$ (hence $s \in C_0'$), code of point {\bf (a)};
%\item the element $s$ has been provided by the context, i.e. $s \in C_1 $ (hence $s \in C_0'$), code of point {\bf (e)}
%\item both the previous cases 1) and 2)
%\end{enumerate}
%Also, some reaction $a \in A$, requiring the presence of the entity $s$, could have been applied, and all the rules requiring the absence of $s$ could not have been applied.\\
%%Then, let $R_i = [e';e'',e]$ be a rule producing $e$ with $e'' \neq e$, and let $i$ be its associated number. \\
%%By hypothesis, $s \in C_0'$, then it must be that at least a process with code structure of points {\bf (a)}or a process with code structure of point
%
%It follows that process $P_s$ has participated in the transition with code of point {\bf (f)} with $z \geq 0$, or with code of point {\bf (g)}. Then we have that  $P' \defeq \restrict{reacts,ctxs,ents}(P_s | B)$.\\
%
%\noindent
%The other cases can be proved in a  similar way.\\
\end{proof}
 
%\noindent
%We recall Corollary~\ref{corr:compl2}
%(the original appears on p.\,\pageref{corr:compl2}).
\corrcompldue*
 
% \begin{corollary}[completeness2]
% \label{prop:completeness}
%  Let ${\cal A} = (S, A)$ be a $rs$, and let $\pi=(\gamma,\delta)$ be a $n$-step interactive process in ${\cal A}$ with $\gamma = C_0,\dots,C_n$ and $\delta = D_0,\dots,D_n$. Let $P=[|{\cal A},\gamma|]$ its c\CNA \ translation. If we define $\pi'= (\gamma',\delta')$  with   $\gamma' = C_0',\dots,C_{n-1}'$ and $\delta' = D_0',\dots,D_{n-1}'$  as
%  $C_0'=C_w \cup D_w$, and   $C_i'=C_{i+w}$, $D_i' = D_{i+w}$ with $1 \leq i \leq n-w $, then $\exists$ $P'$ such that $P \rightarrow^w P'$ and  $P'=[|{\cal A},\gamma'|]$.  
% \end{corollary}
 \begin{proof}
 The proof proceeds by induction on the number $j$, and it is similar to the one of Corollary~\ref{corr:corr2}\\
% case $j=0$\\
% It is enough to set $C_0' = C_0 \cup D_0$ and $P' =P$.\\
% case $j=1$\\
% This case falls into the case of Proposition~\ref{prop:compl1}.\\
% case $j>1$\\
% We set $C_0'=C_w \cup D_w = C_1'' \cup D_1''$, $C_g' = C_{n-w}= C_{g+1}''$, and $D_g' = D_{n-w} = D_{g+1}''$, with $1 \leq  g < n-w$.\\
% By inductive hypothesis, it holds that $\exists$ $P''$ such that $P \xrightarrow{\link{\silent}{\silent}}^{w-1} P''$ and $P'' = [| {\cal A},\gamma'|]$.
% By Lemma~\ref{lem:compl2}.1, it exists $P'$ such that $P'' \xrightarrow{\link{\silent}{\silent}} P'$,
% and $P' = [|{\cal A},\gamma'|]$. By Lemma~\ref{lem:compl2}.2, $P'$ is unique.
%% By Lemma~\ref{lem:compl2}.2, if $\exists$ $P'$ such that $P'' \xrightarrow{\link{\silent}{\silent}} P'$, then $P'$ is 
% %unique, and by Lemma~\ref{lem:compl2}.1 $P' = [|{\cal A},\gamma'|]$. 
% And we are done. 
 \end{proof}
 
 
 \newpage
 
 \section{The \emph{lac} operon encoding}
 \begin{table}[h]
{\small
\[
\boxed{
\begin{array}{lcl}
P_{cAMP\textrm{-}CAP} & \defeq & %P_{cAMP\textrm{-}CAP}(cAMP\textrm{-}CAP)=\\
\sum_{h =0}^1 ( \startchain{cAMP\textrm{-}CAP_i}\chainedlink{cAMP\textrm{-}CAP_o}{\noact}\chainend{\noact})^h\,  \startchain{\widetilde{cAMP\textrm{-}CAP}_i}\chainend{\widetilde{cAMP\textrm{-}CAP}_o}.P_{cAMP\textrm{-}CAP}\\
&&+\\
&&\link{cAMP\textrm{-}CAP_i}{cAMP\textrm{-}CAP_o} .\overline{P_{cAMP\textrm{-}CAP}}\\
\\
\overline{P_{cAMP\textrm{-}CAP}} & \defeq &
\sum_{h =0}^1  ( \startchain{\overline{cAMP\textrm{-}CAP}_i}\chainedlink{\overline{cAMP\textrm{-}CAP}_o}{\noact}\chainend{\noact})^h\ \link{\widetilde{cAMP\textrm{-}CAP}_i}{\widetilde{cAMP\textrm{-}CAP}_o} .P_{cAMP\textrm{-}CAP}\\
&&+\\
&&\link{\overline{cAMP\textrm{-}CAP}_i}{\overline{cAMP\textrm{-}CAP}_o} .\overline{P_{cAMP\textrm{-}CAP}}\\
\end{array}}
\]}
\caption{The process for $cAMP\textrm{-}CAP$.}\label{tab:cAMP-CAP}
%\end{table}
%
%\begin{table}[h]
\[
\boxed{
\begin{array}{lcl}
P_{glucose} &\defeq &
\sum_{h=0}^1 (\startchain{glucose_i}\chainedlink{glucose_o}{\noact}\chainend{\noact})^h\ \link{\widehat{glucose_i}}{\widehat{glucose_o}}.P_{glucose}
\\
&& + \\
&& \sum_{h=0}^1 (\startchain{glucose_i}\chainedlink{glucose_o}{\noact}\chainend{\noact})^h\ \link{\underline{glucose_i}}{\underline{glucose_o}}.\overline{P_{glucose}}\\
\\
\overline{P_{glucose}} &\defeq &\sum_{h=0}^1 (\startchain{\overline{glucose}_i}\chainedlink{\overline{glucose}_o}{\noact}\chainend{\noact})^h\ \link{\widehat{glucose_i}}{\widehat{glucose_o}}.P_{glucose}\\
&&+\\
&& \sum_{h=0}^1 (\startchain{\overline{glucose}_i}\chainedlink{\overline{glucose}_o}{\noact}\chainend{\noact})^h\ \link{\underline{glucose_i}}{\underline{glucose_o}}.\overline{P_{glucose}}\\
\end{array}}
\]
\caption{The process for $glucose$.}\label{tab:glucose}
%\end{table}
%
%\begin{table}[h]
\[
\boxed{
\begin{array}{lcl@{\qquad}lcl}
P_A&\defeq &\startchain{\tilde{A_i}}\chainedlink{\tilde{A_o}}{\noact}\chainedlink{\noact}{\underline{A_i}}\chainend{\underline{A_o}}.P_A\ + \
\link{\underline{A_i}}{\underline{A_o}}.\overline{P_A}
&
P_y&\defeq &\startchain{\tilde{y_i}}\chainedlink{\tilde{y_o}}{\noact}\chainedlink{\noact}{\underline{y_i}}\chainend{\underline{y_o}}.P_y\ + \
\link{\underline{y_i}}{\underline{y_o}}.\overline{P_y}
\\
\overline{P_A} &\defeq &\startchain{\tilde{A_i}}\chainedlink{\tilde{A_o}}{\noact}\chainedlink{\noact}{\underline{A_i}}\chainend{\underline{A_o}}.\overline{P_A}\ + \
\link{\underline{A_i}}{\underline{A_o}}.\overline{P_A}
&
\overline{P_y} &\defeq &\startchain{\tilde{y_i}}\chainedlink{\tilde{y_o}}{\noact}\chainedlink{\noact}{\underline{y_i}}\chainend{\underline{y_o}}.\overline{P_y}\ + \
\link{\underline{y_i}}{\underline{y_o}}.\overline{P_y}
\end{array}}
\]
\caption{The processes for $y$ and $A$.}\label{tab:yA}

\end{table}
